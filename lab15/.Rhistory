setwd("/Users/sgbryan/Desktop/BIS15W2024_sbryan/lab15")
knitr::opts_chunk$set(echo = TRUE)
#explore the data
head(netflix)
netflix <- read_csv("Data/netflix_titles.csv")
library(tidyverse)
library(tidyverse)
library(janitor)
library(dplyr)
library(dplyr)
library(shiny)
library(tidyverse)
library(janitor)
library(dplyr)
library(shiny)
library(shinydashboard)
netflix <- read_csv("Data/netflix_titles.csv")
#explore the data
head(netflix)
glimpse(netflix)
View(netflix)
View(netflix)
#sort out the movies from the netflix data
netflix_movies <- netflix %>% filter(type == "Movie")
#find director with the most movies on netflix
netflix_movies %>% count(director, sort = TRUE)
#find director with the most movies on netflix
netflix_movies %>%
filter(director != "NA") %>%
count(director, sort = TRUE)
#Which director has the most movies on netflix? Filter out NA's
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE)
#Which director had the most movies by release year and remove the NA's?
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, release_year, sort = TRUE)
#Which director had the most movies by release year and remove the NA's? Seperate commas in the director column
netflix_movies <- netflix_movies %>%
separate_rows(director, sep = ", ") %>%
filter(!is.na(director)) %>%
count(director, release_year, sort = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
library(shiny)
library(shinydashboard)
#load the Netflix Data in your Data folder, save it under the object name netflix
netflix <- read_csv("Data/netflix_titles.csv")
#explore the data
head(netflix)
glimpse(netflix)
#sort out the movies from the netflix data
netflix_movies <- netflix %>% filter(type == "Movie")
#find director with the most movies on netflix
netflix_movies %>%
filter(director != "NA") %>%
count(director, sort = TRUE)
#Which director has the most movies on netflix? Filter out NA's
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE)
#Which director had the most movies by release year and remove the NA's?
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, release_year, sort = TRUE)
#Which director had the most movies by release year and remove the NA's? Seperate commas in the director column
netflix_movies %>%
separate_rows(director, sep = ", ") %>%
filter(!is.na(director)) %>%
count(director, release_year, sort = TRUE)
#make a bar plot of the top directors with the most movies on netflix
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x = "Director",
y = "Number of Movies")
#make a bar plot of the top directors with the most movies on netflix
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x = "Director",
y = "Number of Movies")
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
theme_minimal() +
theme(legend.position = "none") +
labs(title = "Top 10 Directors with the Most Movies on Netflix", x = "Director", y = "Number of Movies")
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors") +
theme_minimal() +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors",
x= "Directors",
y= "Number of Movies") +
theme_minimal() +
theme(legend.position = "none")
labs(title = "Top 10 Directors with the Most Movies on Netflix",",
#make a bar plot of the top directors with the most movies on netflix, fill by director. Remove the legend flip axis and make the title "Top 10 Directors"
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme_minimal() +
theme(legend.position = "none")
#Which director had the most movies by release year and remove the NA's? Seperate commas in the director column
netflix_movies <- netflix_movies %>%
separate_rows(director, sep = ", ") %>%
filter(!is.na(director)) %>%
count(director, release_year, sort = TRUE)
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme_minimal() +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE) %>%
top_n(10, n) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE) %>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
filter(year==2020) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(year == 2020) %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(as.factor(year) == 2020) %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
#make variable year a factor
netflix_movies$release_year <- as.factor(netflix_movies$release_year)
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE) %>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE) %>%
top_n(10, director)
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE)
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE)%>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
#make the top 10 directors barplot into a Shiny App
```
#make the top 10 directors barplot into a Shiny App
ui <- fluidPage(
titlePanel("Top 10 Directors with the Most Movies on Netflix in 2020"),
plotOutput("barplot")
)
server <- function(input, output) {
output$barplot <- renderPlot({
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == 2020) %>%
count(director, sort = TRUE)%>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix in 2020",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
})
}
shinyApp(ui = ui, server = server)
#make the top 10 directors barplot into an interactive Shiny App for all years
ui <- fluidPage(
titlePanel("Top 10 Directors with the Most Movies on Netflix"),
sidebarLayout(
sidebarPanel(
helpText("Select a year to view the top 10 directors with the most movies on Netflix"),
selectInput("year", "Year", choices = unique(netflix_movies$release_year))
),
mainPanel(
plotOutput("top_directors")
)
)
)
server <- function(input, output) {
output$top_directors <- renderPlot({
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == input$year) %>%
count(director, sort = TRUE)%>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
})
}
shinyApp(ui = ui, server = server)
#make the top 10 directors barplot into an interactive Shiny App for all years, include an option to view number of movies for all years, or just one year at a time
ui <- fluidPage(
titlePanel("Top 10 Directors with the Most Movies on Netflix"),
sidebarLayout(
sidebarPanel(
selectInput("year", "Select a year", choices = c("All", unique(netflix_movies$release_year)))
),
mainPanel(
plotOutput("top_directors")
)
)
)
server <- function(input, output) {
output$top_directors <- renderPlot({
if(input$year == "All") {
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
} else {
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == input$year) %>%
count(director, sort = TRUE)%>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = paste("Top 10 Directors with the Most Movies on Netflix in", input$year),
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
}
})
}
shinyApp(ui = ui, server = server)
#make the top 10 directors barplot into an interactive Shiny App for all years, include an option to view number of movies for all years, or one year at a time
ui <- fluidPage(
titlePanel("Top 10 Directors with the Most Movies on Netflix"),
sidebarLayout(
sidebarPanel(
selectInput("year", "Select a year", choices = c("All", unique(netflix_movies$release_year)))
),
mainPanel(
plotOutput("top_directors")
)
)
)
server <- function(input, output) {
output$top_directors <- renderPlot({
if(input$year == "All") {
netflix_movies %>%
filter(!is.na(director)) %>%
count(director, sort = TRUE) %>%
top_n(10) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = "Top 10 Directors with the Most Movies on Netflix",
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
} else {
netflix_movies %>%
filter(!is.na(director)) %>%
filter(release_year == input$year) %>%
count(director, sort = TRUE)%>%
top_n(10, director) %>%
ggplot(aes(x = fct_reorder(director, n), y = n, fill = director)) +
geom_col() +
coord_flip() +
labs(title = paste("Top 10 Directors with the Most Movies on Netflix in", input$year),
x= "Directors",
y= "Number of Movies") +
theme(legend.position = "none")
}
})
}
shinyApp(ui = ui, server = server)
