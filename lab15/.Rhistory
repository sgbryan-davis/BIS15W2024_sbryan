axis.title.x = element_text(size = 5))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 5))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title. = element_text(size = 10))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title. = element_text(size = 10))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 5))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 6))
# scatterplot exercise hours vs blood pressure, colored by gender
heart %>%
ggplot(aes(x=exercise_hours_week, y=blood_pressure_mm_hg, color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 6))
reg1 <- lm(blood_pressure_mm_hg ~ weight_kg, data = heart)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(ggplot2)
library(ggthemes)
library(shiny)
#install.packages("shinydashboard")
library(shinydashboard)
diabetes <- read_csv("diabetes_prediction_data.csv") %>% clean_names()
glimpse(diabetes)
diabetes %>%
ggplot(aes(age, fill = "purple3")) +
geom_density(color= "black") +
reg1 <- lm(blood_pressure_mm_hg ~ weight_kg, data = heart)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
library(skimr)
library(ggthemes)
options(scipen = 999)
clownfish_endurance <- read_csv("data/endurance_of_clownfish.csv")
clownfish_endurance %>%
ggplot(aes(speed)) +
geom_histogram(bins = 5, color= "black", fill = "orange", alpha = 0.8) +
labs(title = "Speed of Clownfish", x = "Speed (cm/sec)", y = "Frequency") +
theme_economist() +
theme(plot.title = element_text(hjust = 0.5))
# move graph legend to the left, title to the middle
clownfish_endurance %>%
filter(dist_cm != "NA") %>%
ggplot(aes(x= log10(dist_cm), y=log10(time_sec), color = speed)) +
geom_point() +
theme_economist() +
labs(title = "Clownfish Endurance", x = "Distance ( log10(cm) )", y = "Time ( log10(sec) )", color = "Speed (cm/sec)") +
theme(legend.position = "right") +
theme(plot.title = element_text(hjust = 0.5))
clownfish_endurance_2 <- clownfish_endurance %>%
filter(dist_cm != "NA") %>%
select(speed, dist_cm, time_sec) %>%
mutate(dist_km = dist_cm / 100000) %>%
mutate(time_hr = time_sec / 3600) %>%
arrange(-dist_km)
clownfish_endurance_2 %>%
select(dist_km, time_hr) %>%
mutate(speed_km_hr = dist_km / time_hr) %>%
top_n(10, dist_km) %>%
arrange(-dist_km)
clownfish_endurance_2 %>%
select(dist_km, time_hr) %>%
mutate(speed_with_current = dist_km/time_hr + 7) %>%
mutate(days_to_sydney = (1860 / speed_with_current) / 24)  %>%
arrange(-dist_km)
clownfish_endurance_2 %>%
select(dist_km, time_hr) %>%
mutate(speed_with_current = dist_km/time_hr + 7) %>%
mutate(days_to_sydney = (1860 / speed_with_current) / 24)  %>%
ggplot(aes(days_to_sydney)) +
geom_density(fill = "orange", alpha = 0.7) +
theme_economist() +
labs(title = "Time to Sydney with Current", x = "Time (Days)", y = "Density") +
theme(plot.title = element_text(hjust = 0.5))
clownfish_endurance %>%
filter(tl != "NA") %>%
ggplot(aes(tl)) +
geom_density(fill= "orange", alpha = 0.7) +
theme_economist() +
labs(title = "Total Length of Clownfish", x = "Total Length (cm)", y = "Density") +
theme(plot.title = element_text(hjust = 0.5))
View(clownfish_endurance)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
blood_count <- read_csv("data/blood_count.csv")
blood_count <- read_csv("data/blood_count_data_set.csv")
setwd("/Users/staff/Desktop/BIS15W2024_sbryan/lab15")
blood_count <- read_csv("data/blood_count_data_set.csv")
blood_count <- read_csv("data/blood_count_data_set.csv")
blood_count <- read_csv("data/blood_count_dataset.csv")
glmpse(blood_count)
glimpse(blood_count)
blood_count %>%
group_by(gender) %>%
summarize(min=min(red_blood_cells),
mean=maen(red_blood_cells),
max=max(red_blood_cells))
blood_count %>%
group_by(gender) %>%
summarize(min=min(red_blood_cells),
mean=mean(red_blood_cells),
max=max(red_blood_cells))
blood_count %>%
filter(Gender = "male") %>%
select[3:9] %>%
colMeans(na.rm = TRUE)
options(scipen = 999, digits = 2)
blood_count %>%
filter(Gender == "male") %>%
select[3:9] %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(Gender == "male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
bloood_count %>%
filter(Gender == "Female") %>%
select(3:9) %>%
colMeans(na.rm = T)
blood_count %>%
filter(Gender == "Female") %>%
select(3:9) %>%
colMeans(na.rm = T)
blood_count %>%
pivot_wider(cols = (3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Gender, y = Values, fill = Gender)) +
geom_boxplot() +
facet(~ Test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Test",
y = "Values")
blood_count %>%
pivot_wider(cols = [3:9], names_to = "Test", values_to = "Values") %>%
blood_count %>%
pivot_wider(cols = c(3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Gender, y = Values, fill = Gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
View(blood_count)
blood_count <- read_csv("data/blood_count_dataset.csv") %>% clean_names()
blood_count %>%
group_by(gender) %>%
summarize(min=min(red_blood_cells),
mean=mean(red_blood_cells),
max=max(red_blood_cells))
blood_count %>%
filter(Gender == "male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(gender == "male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(gender == "Female") %>%
select(3:9) %>%
colMeans(na.rm = T)
blood_count %>%
pivot_wider(cols = c(3:9), names_to = "gender", values_to = "values") %>%
ggplot(aes(x = Gender, y = Values, fill = Gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "test", values_to = "values") %>%
ggplot(aes(x = Gender, y = Values, fill = Gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "test", values_to = "values") %>%
ggplot(aes(x = gender, y = values, fill = Gender)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "test", values_to = "values") %>%
ggplot(aes(x = gender, y = values, fill = Gender)) +
geom_boxplot() +
facet_wrap(~ test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "test", values_to = "values") %>%
ggplot(aes(x = gender, y = values, fill = gender)) +
geom_boxplot() +
facet_wrap(~ test, scales = "free") +
labs(title = "Boxplot of Blood Count Tests",
x = "Gender",
y = "Values")
grouped_bc <- blood_count %>%
change(Age_Group = case_when(
Age >= 20 & Age <= 29 ~ "20s",
Age >= 30 & Age <= 39 ~ "30s",
Age >= 40 & Age <= 49 ~ "40s",
Age >= 50 & Age <= 59 ~ "50s",
Age >= 60 & Age <= 70 ~ "60s")) # there were only 4 people in 70s, so I combined it with 60s
grouped_bc <- blood_count %>%
mutate(Age_Group = case_when(
Age >= 20 & Age <= 29 ~ "20s",
Age >= 30 & Age <= 39 ~ "30s",
Age >= 40 & Age <= 49 ~ "40s",
Age >= 50 & Age <= 59 ~ "50s",
Age >= 60 & Age <= 70 ~ "60s")) # there were only 4 people in 70s, so I combined it with 60s
grouped_bc <- blood_count %>%
mutate(Age_Group = case_when(
age >= 20 & age <= 29 ~ "20s",
age >= 30 & age <= 39 ~ "30s",
age >= 40 & age <= 49 ~ "40s",
age >= 50 & age <= 59 ~ "50s",
age >= 60 & age <= 70 ~ "60s")) # there were only 4 people in 70s, so I combined it with 60s
head(grouped_bc)
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(ase(x = Age_Group, y = values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = 3:9, names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = Values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap( Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
pivot_longer(cols = c(3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = Values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
grouped_bc %>%
pivot_longer(cols = c(3:9), names_to = "Test", values_to = "Values") %>%
ggplot(aes(x = Age_Group, y = Values, fill = Age_Group)) +
geom_boxplot() +
facet_wrap(~ Test, scales = "free") +  # Facet by the "Test" variable
labs(title = "Boxplot of Blood Count Tests by Age Group",
x = "Age Group",
y = "Values")
blood_count %>%
filter(gender == "male") %>%
select(c(3:9)) %>%
colMeans(na.rm = TRUE)
blood_count %>%
filter(gender == "Male") %>%
select(3:9) %>%
colMeans(na.rm = TRUE)
heart <-read_csv("heart.csv") %>% clean_names()
reg1 <- lm(blood_pressure_mm_hg ~ weight_kg, data = heart)
View(heart)
reg1 <- lm(blood_pressure_mm_hg ~ weight_kg, data = heart)
reg1 <- lm(heart_attack ~ weight_kg + , data = heart)
reg1 <- lm(heart_attack ~ weight_kg  , data = heart)
summuary(reg1)
summary(reg1)
reg2 <- lm(heart_attack ~ cholesterol_mg_d_l  , data = heart)
summary(reg2)
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + blood_pressure_mm_hg  , data = heart)
summary(reg3)
heart %>%
separate(col = "blood_pressure_mm_hg", into = c("systolic_bp", "diastolic_bp"), sep = "/")
heart_bp <- heart %>%
separate(col = "blood_pressure_mm_hg", into = c("systolic_bp", "diastolic_bp"), sep = "/")
heart_bp <- heart %>%
separate(col = "blood_pressure_mm_hg", into = c("systolic_bp", "diastolic_bp"), sep = "/")
heart_bp %>%
ggplot(aes(x=cholesterol_mg_d_l, y=systolic_bp, color= gender)) +
geom_jitter() +
labs(title = "Cholesterol vs Blood Pressure",
x = "Cholesterol (mg/dL)",
y = "Blood Pressure (mm Hg)" )
heart_bp %>%
ggplot(aes(x=cholesterol_mg_d_l, y=systolic_bp, color= gender)) +
geom_jitter() +
labs(title = "Cholesterol vs Blood Pressure",
x = "Cholesterol (mg/dL)",
y = "Blood Pressure (mm Hg)" ) +
geom_smooth(method = "lm")
head(heart_bp)
heart_bp %>%
ggplot(aes(x=cholesterol_mg_d_l, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Cholesterol vs Blood Pressure",
x = "Cholesterol (mg/dL)",
y = "Blood Pressure (mm Hg)" ) +
geom_smooth(method = "lm")
# scatter plot for weight vs blood pressure, color by gender
heart_bp %>%
ggplot(aes(x=weight_kg, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Weight vs Blood Pressure",
x = "Weight (kg)",
y = "Blood Pressure (mm Hg)" )
# scatter plot for weight vs blood pressure, color by gender
heart_bp %>%
ggplot(aes(x=weight_kg, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Weight vs Blood Pressure",
x = "Weight (kg)",
y = "Blood Pressure (mm Hg)" ) +
theme_minimal() +
geom_smooth(method = "lm")
# scatter plot for weight vs blood pressure, color by gender
heart_bp %>%
ggplot(aes(x=weight_kg, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Weight vs Blood Pressure",
x = "Weight (kg)",
y = "Blood Pressure (mm Hg)" ) +
theme_minimal() +
geom_smooth(method = "lm") +
theme(plot.title = element_text(hjust = 0.5))
# scatterplot exercise hours vs blood pressure, colored by gender
heart_bp %>%
ggplot(aes(x=exercise_hours_week, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 6))
# scatterplot exercise hours vs blood pressure, colored by gender
heart_bp %>%
ggplot(aes(x=exercise_hours_week, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
geom_smooth(method = "lm") +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Blood Pressure (mm Hg)" ) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 6))
# scatterplot exercise hours vs blood pressure, colored by gender
heart_bp %>%
ggplot(aes(x=exercise_hours_week, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
geom_smooth(method = "lm") +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Systolic Blood Pressure (mm Hg)" ) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_text(size = 10),
axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 6))
# scatter plot for weight vs blood pressure, color by gender
heart_bp %>%
ggplot(aes(x=weight_kg, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Weight vs Blood Pressure",
x = "Weight (kg)",
y = "Systolic Blood Pressure (mm Hg)" ) +
theme_minimal() +
geom_smooth(method = "lm") +
theme(plot.title = element_text(hjust = 0.5))
heart_bp %>%
ggplot(aes(x=cholesterol_mg_d_l, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Cholesterol vs Blood Pressure",
x = "Cholesterol (mg/dL)",
y = "Systolic Blood Pressure (mm Hg)" ) +
geom_smooth(method = "lm")
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + systolic_bp , data = heart_bp))
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + systolic_bp , data = heart_bp))
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + systolic_bp , data = heart_bp)
summary(reg3)
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + as.numeric(systolic_bp) , data = heart_bp)
summary(reg3)
heart_bp %>%
ggplot(aes(x=cholesterol_mg_d_l, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
labs(title = "Cholesterol vs Blood Pressure",
x = "Cholesterol (mg/dL)",
y = "Systolic Blood Pressure (mm Hg)" ) +
geom_smooth(method = "lm") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# scatterplot exercise hours vs blood pressure, colored by gender
heart_bp %>%
ggplot(aes(x=exercise_hours_week, y=as.numeric(systolic_bp), color= gender)) +
geom_jitter() +
geom_smooth(method = "lm") +
labs(title = "Exercise Hours vs Blood Pressure",
x = "Exercise Hours",
y = "Systolic Blood Pressure (mm Hg)" ) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + as.numeric(systolic_bp) , data = heart_bp) %>%
summary(reg3)
reg3 <- lm(heart_attack ~ cholesterol_mg_d_l + weight_kg + as.numeric(systolic_bp) , data = heart_bp) %>%
summary(reg3)
summary(reg3)
